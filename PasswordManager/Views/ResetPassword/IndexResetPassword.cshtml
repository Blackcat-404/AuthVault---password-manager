@using PasswordManager.ViewModels
@model ResetPasswordViewModel
@{
    ViewData["Title"] = "Reset Password";
    ViewData["BodyClass"] = "auth-page";
    Layout = "_Layout";
}
<div class="login-container">
    <!-- Application logo -->
    <div class="logo">
        <div class="logo-icon">
            <svg xmlns="http://www.w3.org/2000/svg"
                 width="24"
                 height="24"
                 viewBox="0 0 24 24"
                 fill="none"
                 stroke="currentColor"
                 stroke-width="2"
                 stroke-linecap="round"
                 stroke-linejoin="round">
                <path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z" />
            </svg>
        </div>
        <div class="logo-title">
            <svg viewBox="0 0 400 120" class="logo-svg">
                <text x="50%" y="50%" text-anchor="middle"
                      dominant-baseline="middle"
                      class="logo-text-outline">
                    AuthVault
                </text>
                <text x="50%" y="50%" text-anchor="middle"
                      dominant-baseline="middle"
                      class="logo-text-fill">
                    AuthVault
                </text>
            </svg>
        </div>
    </div>
    <!-- Tagline -->
    <div class="tagline">
        <p>Create a new master password</p>
    </div>
    <!-- Reset Password form -->
    <form asp-controller="ResetPassword" asp-action="PostResetPassword" method="post">
        @Html.AntiForgeryToken()
        <input type="hidden" asp-for="Token" />

        <div class="form-group">
            <label asp-for="NewPassword">New Master Password</label>
            <div class="password-wrapper">
                <input asp-for="NewPassword"
                       id="new-password"
                       class="form-control"
                       placeholder="Enter new master password" />
                <button type="button"
                        class="toggle-password"
                        onclick="togglePassword('new-password', this)">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         viewBox="0 0 24 24"
                         fill="none"
                         stroke="currentColor"
                         stroke-width="2"
                         stroke-linecap="round"
                         stroke-linejoin="round">
                        <path d="m15 18-.722-3.25" />
                        <path d="M2 8a10.645 10.645 0 0 0 20 0" />
                        <path d="m20 15-1.726-2.05" />
                        <path d="m4 15 1.726-2.05" />
                        <path d="m9 18 .722-3.25" />
                    </svg>
                </button>
            </div>
            <span asp-validation-for="NewPassword" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="ConfirmPassword">Confirm New Password</label>
            <div class="password-wrapper">
                <input asp-for="ConfirmPassword"
                       id="confirm-password"
                       class="form-control"
                       placeholder="Confirm new master password" />
                <button type="button"
                        class="toggle-password"
                        onclick="togglePassword('confirm-password', this)">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         viewBox="0 0 24 24"
                         fill="none"
                         stroke="currentColor"
                         stroke-width="2"
                         stroke-linecap="round"
                         stroke-linejoin="round">
                        <path d="m15 18-.722-3.25" />
                        <path d="M2 8a10.645 10.645 0 0 0 20 0" />
                        <path d="m20 15-1.726-2.05" />
                        <path d="m4 15 1.726-2.05" />
                        <path d="m9 18 .722-3.25" />
                    </svg>
                </button>
            </div>
            <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
        </div>

        <button type="submit" class="submit-btn">Reset Password</button>
    </form>

    <div class="forgot-password">
        <a asp-controller="Account" asp-action="Login">
            <svg xmlns="http://www.w3.org/2000/svg"
                 width="16"
                 height="16"
                 viewBox="0 0 24 24"
                 fill="none"
                 stroke="currentColor"
                 stroke-width="2"
                 stroke-linecap="round"
                 stroke-linejoin="round"
                 style="vertical-align: middle; margin-right: 4px;">
                <path d="m12 19-7-7 7-7" />
                <path d="M19 12H5" />
            </svg>
            Back to login
        </a>
    </div>
</div>

@section Styles {
    <link rel="stylesheet" href="~/css/account.css" asp-append-version="true" />
}

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script>
        function togglePassword(inputId, button) {
            const input = document.getElementById(inputId);
            const isPassword = input.type === 'password';
            input.type = isPassword ? 'text' : 'password';

            // Update icon
            button.innerHTML = isPassword
                ? `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                     <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/>
                     <circle cx="12" cy="12" r="3"/>
                   </svg>`
                : `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                     <path d="m15 18-.722-3.25" />
                     <path d="M2 8a10.645 10.645 0 0 0 20 0" />
                     <path d="m20 15-1.726-2.05" />
                     <path d="m4 15 1.726-2.05" />
                     <path d="m9 18 .722-3.25" />
                   </svg>`;
        }
    </script>
}
